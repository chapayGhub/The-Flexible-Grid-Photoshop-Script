/*  * @title   The Flexible Grid Script  * @desc    This is a script for Photoshop that generates a .psd file with the grid defined by you.  *          It's useful for creating a grid system template typically used in RWD (Responsive Web Design).  *          The benefits are being able to customize columns and spans automatically, instead of manually.  *          You'll have to specify the number of columns, the column span, document width & height in 72dpi.  *          If no document is open, it creates a new document for you, otherwise it resizes the current  *          document's canvas size to the desired width/height while adding the specified grid to that  *          current document. You can find more of my free Photoshop automation scripts at workfunc.com.  *  * @author  Jonah Bitautas, http://workfunc.com */#target "photoshop"if(BridgeTalk.appName == "photoshop") {    app.bringToFront;    preferences.rulerUnits = Units.PIXELS;        var setW = Number(prompt("Enter the layout width: ", "960")),         setH = Number(prompt("Enter the layout height: ", "600")),         columns = Number(prompt("Enter the amount of columns: ", "12")),         colSpan = Number(prompt("Enter the amount of space between columns: ", "10"));            if (app.documents.length == 0)         doc = app.documents.add(setW, setH, 72, "Untitled-workFunc-01", NewDocumentMode.RGB);    else         doc = app.activeDocument;            var gutter = Number(colSpan) * 2,                 maxDoc = Number(setW * 0.5) + Number(setW * 0.5),         minDoc = Number(setW * 0.5) - Number(setW * 0.5),                 minDocMargin = minDoc + colSpan,         maxDocMargin = maxDoc - colSpan,                 colW = (setW - (columns * gutter)) / columns;        doc.guides.add(Direction.VERTICAL, minDoc);    doc.guides.add(Direction.VERTICAL, maxDoc);        for (var i = 0; i < columns; i++) {        pos = minDocMargin + ((colW + gutter) * i);                if (pos > maxDocMargin) break;                doc.guides.add(Direction.VERTICAL, Number(pos));    }        for (var j = 0 ; j < columns; j++ ) {    	if (j == 0) multiply = 0;        else multiply = 1;                temp = (gutter * multiply);                pos = (minDoc - colSpan) + ((colW + gutter) * (j + 1));                if (pos > maxDocMargin) break;                doc.guides.add(Direction.VERTICAL, Number(pos));    }    alert("Thanks for using The Flexible Grid Script! You can find more scripts for Photoshop at workfunc.com");}